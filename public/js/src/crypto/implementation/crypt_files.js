/*
* @name: fileEncryption()
* @description: encrypt the file before uploading
* @params: file, cek is the content encryption key and CEK is a bits array
* @dependencies: base64.js
* @note: the CEK is there a passphrase, not a key composed of
* the salt and the secrete password and the iteration
* This system allow us to get a different key for all the files
* even if the params are readable.
* Also, the salt is randomly generated by SJCL.
* The file is encrypted to don't get a bug issue about the binary files encryption
*/
var fileEncryption = function(file, cek)
{
	var cek = sjcl.codec.base64.toBits(cek);
	var file = base64.encode(file);
	var aDATA = sjcl.random.randomWords(1);
	var aDATA = sjcl.codec.base64.fromBits(aDATA);
	var cipheredFile = sjcl.encrypt(cek, file,{
		mode:'gcm', iter:2000, ks:256, ts:128, adata:aDATA
	});
	return cipheredFile;
}


/*
* @name: fileDecryption()
* @description: decrypt the file after being downloaded
* @params: file, cek (cek is a bits array)
* @dependencies: base64.js
*/
var fileDecryption = function(file, cek)
{
	var cek = sjcl.codec.base64.toBits(cek);
	var decryptedFile = sjcl.decrypt(cek, file);
	var decryptedFile = base64.decode(file);
	return decryptedFile;
}
